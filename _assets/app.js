var f="x-action",C=new MutationObserver(t=>{for(let e of t){if(e.type==="attribute"){y(e.target);continue}if(e.type==="childList"){for(let o of e.removedNodes)o.$binds&&(o.$binds=null);for(let o of e.addedNodes)o.nodeType===Node.ELEMENT_NODE&&y(o);continue}}});document.readyState==="complete"?b():document.addEventListener("DOMContentLoaded",b,{once:!0});function b(){let t=document.body;C.observe(t,{childList:!0,subtree:!0,attributeFilter:[f]});for(let e of t.querySelectorAll(`[${f}]`))y(e)}function y(t){if(!t.hasAttribute(f))return;let e=t.getAttribute(f).split(/\s+/),o=t.$binds={};for(let s of e){let i=s.lastIndexOf(":"),n=Math.max(0,s.lastIndexOf("#"))||s.length,c=s.slice(0,i),a=s.slice(i+1,n),l=s.slice(n+1)||"handleEvent";if(!a.includes("-"))continue;let r=t.closest(a);if(!r)continue;let d=customElements.get(a)?r:a;t.addEventListener(c,k);let h=o[c];if(!h){o[c]=E(d,l);continue}for(;h.next;)h=h.next;h.next=E(d,l)}}function k(t){let e=t.currentTarget,o=e.$binds;if(!o)return;let s=o[t.type];for(;s;){let i=s.method,n=s.target;if(typeof n=="string"){if(!customElements.get(n)){s=s.next;continue}n=s.target=e.closest(n)}n[i]&&n[i](t),s=s.next}}function E(t,e){return{target:t,method:e,next:null}}function u(t,e){return t.querySelector(`[x-target~='${t.localName}.${e}']`)||null}var{default:g}=await import("./data-BAXXPTDF.js"),x=class extends HTMLElement{searchField=u(this,"searchField");autocompleteContainer=u(this,"autocompleteContainer");augmentsContainer=u(this,"augmentsContainer");displayContainer=u(this,"displayContainer");commitHash=u(this,"commitHash");searchResults=[];searchIndex=-1;searchInitialized=!1;searchDirty=!1;augments;connectedCallback(){let o=new URLSearchParams(location.search).get("augments")?.split(",")||[];this.augments=o,this.commitHash.textContent="171517",this.calculate(),this._initializeSearch()}calculate(){let e=this.augments,{scores:o,unknowns:s}=$(e);for(let a in o){let l=s[a],r=o[a],d=/pot|resist|crit|drop/.test(a)?`${r.toFixed(2)}%`:r,h=document.getElementById(a),p=h.previousElementSibling,m=r||l;p.classList.toggle("highlight",m),h.classList.toggle("highlight",m),h.textContent=`${d}${l?" ?":""}`}let i=this.augmentsContainer,n=[...i.childNodes],c=0;for(;c<e.length;c++){let a=e[c],l=g[a],r=n[c];if(!!l){if(r){r.textContent=l.name,r.dataset.value=a;continue}r=document.createElement("li"),r.textContent=l.name,r.dataset.value=a,r.tabIndex=0,r.setAttribute("x-action","click:x-app#handleAugmentClick keydown:x-app#handleAugmentKeydown"),i.appendChild(r)}}for(;c<n.length;c++)n[c].remove()}handleAugmentClick(e){let s=e.target.dataset.value,i=this.augments,n=i.indexOf(s);n!==-1&&(i.splice(n,1),this._replaceUrl(),this.calculate(),this.searchDirty=!0)}handleAugmentKeydown(e){e.key==="Enter"&&this.handleAugmentClick(e)}handleSearchKeydown(e){let o=e.currentTarget,s=e.key,i=this.searchResults,n=this.searchIndex,c=s==="ArrowUp",a=s==="ArrowDown",l=s==="Enter";if(s==="Escape")o.parentNode.classList.add("escaped");else if(l)n>-1&&i[n].click();else if(c||a){e.preventDefault();let d=i.length,p=n+(c?-1:1);if(p<0?p=d-1:p>=d&&(p=d?0:-1),n!==-1&&i[n].classList.remove("selected"),p!==-1){let m=i[p];m.classList.add("selected"),m.scrollIntoView({block:"nearest"})}this.searchIndex=p}}handleSearchInput(e){let o=this.searchDirty,s=e.target,i=s.parentNode,n=s.dataset.query,c=s.value.trim().toLowerCase();if(n===c&&!o)return;let a=this.autocompleteContainer,l=!o&&n&&c.startsWith(n)?this.searchResults:a.childNodes,r=[];i.classList.remove("escaped");for(let h of l){let p=h.dataset,m=c&&!this.augments.includes(p.value)&&h.textContent.toLowerCase().includes(c);h.style.setProperty("display",m?"":"none"),m&&r.push(h)}s.dataset.query=c,a.classList.toggle("empty",!r.length);let d=this.searchIndex;d!==-1&&this.searchResults[d].classList.remove("selected"),this.searchIndex=-1,this.searchResults=r}handleSearchFocusIn(e){e.currentTarget.classList.remove("escaped"),this.searchDirty&&(this.handleSearchInput(e),this.searchDirty=!1)}handleSearchItemClick(e){let o=e.target,s=o.dataset.value,i=this.searchResults,n=i.indexOf(o);o.style.setProperty("display","none"),o.classList.remove("selected");let c=!1;if(n!==-1&&(i.splice(n,1),(c=!i.length)&&this.autocompleteContainer.classList.add("empty")),this.searchIndex=c?-1:0,this.searchField.focus(),!c){let l=i[0];l.classList.add("selected"),l.scrollIntoView({block:"nearest"})}this.augments.push(s),this._replaceUrl(),this.calculate()}_initializeSearch(){if(this.searchInitialized)return;this.searchInitialized=!0;let e=this.autocompleteContainer,o=0;for(let s in g){let i=g[s],n=document.createElement("li");n.style.setProperty("display","none"),n.setAttribute("x-action","click:x-app#handleSearchItemClick"),n.textContent=`${i.name}`,n.dataset.bp=i.bp||"0",n.dataset.value=s,n.dataset.idx=o++,e.appendChild(n)}}_replaceUrl(){let e=this.augments.join(",");history.replaceState(null,"",e?`?augments=${e}`:"?")}};customElements.define("x-app",x);function $(t){let e=w(0),o=w(!1);for(let s of t){if(!(s in g))continue;let i=g[s];for(let n in e){if(!(n in i))continue;let c=i[n];c==="?"?o[n]=!0:e[n]+=c}}return{scores:e,unknowns:o}}function w(t){return{bp:t,hp:t,pp:t,exp_grind:t,mel_pot:t,rng_pot:t,tec_pot:t,pot_floor:t,dmg_resist:t,burn_resist:t,freeze_resist:t,shock_resist:t,blind_resist:t,panic_resist:t,poison_resist:t,pain_resist:t,all_resist:t,low_temp_resist:t,fire_pot:t,ice_pot:t,lightning_pot:t,wind_pot:t,light_pot:t,dark_pot:t,daytime_pot:t,nighttime_pot:t,seasonal_pot:t,seasonal_crit:t,seasonal_drop:t}}
//# sourceMappingURL=app.js.map
